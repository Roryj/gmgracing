{"version":3,"sources":["app/shared/gmg.js","app/shared/search.jsx"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"../public/js/app.js","sourcesContent":["/*\r\n * menu\r\n */\r\n\r\nvar menuTimeout = null;\r\nvar menuId = null;\r\nvar current_menu_id = null;\r\n\r\nfunction init_device(){ \r\n    if(jQuery('.device.visible-sm:visible').length > 0)\r\n    {\r\n      jQuery('body').attr('class','device-sm');\r\n    }\r\n    if(jQuery('.device.visible-md:visible').length > 0)\r\n    {\r\n      jQuery('body').attr('class','device-md');\r\n    }\r\n    if(jQuery('.device.visible-lg:visible').length > 0)\r\n    {\r\n      jQuery('body').attr('class','device-lg');\r\n    }\r\n    if(jQuery('.device.visible-xs:visible').length > 0)\r\n    {\r\n      jQuery('body').attr('class','device-xs');\r\n    }\r\n}\r\n\r\nfunction hide_submenu(func1){\r\n  jQuery('#menu-main-menu>li').removeClass('active');\r\n  jQuery('.sub-menu li').fadeOut(500, function(){\r\n    jQuery('.sub-menu').slideUp(500);\r\n  });\r\n\r\n  if(func1){\r\n    func1();\r\n  }\r\n}\r\n\r\nfunction show_submenu(parent){\r\n  parent = jQuery(\"#\" + parent);\r\n  var submenu = jQuery('.sub-menu', parent);\r\n\r\n  jQuery(submenu).css({top: jQuery(parent).height()});\r\n  jQuery('#menu-main-menu>li').removeClass('active');\r\n  jQuery(parent).addClass('active');\r\n  \r\n  submenu.slideDown(500, function(){\r\n    jQuery('li', submenu).fadeIn(500);\r\n  });\r\n}\r\n\r\nfunction init_menu(){\r\n  jQuery('#menu-main-menu .sub-menu').parent('li').addClass(\"parent\");\r\n  jQuery('#menu-main-menu .parent > a').append('<span class=\"caret\"></span>')\r\n  current_menu_id = jQuery('.current-menu-parent').attr('id');\r\n  if(current_menu_id)\r\n  { \r\n    setTimeout(\"show_submenu(current_menu_id);\", 600);\r\n  }\r\n\r\n  jQuery('#menu-main-menu>li').hover(function(e){\r\n      clearTimeout(menuTimeout);\r\n      if(jQuery('.sub-menu:visible', this).length > 0)\r\n      {\r\n        return true;\r\n      }\r\n\r\n      if(jQuery(this).hasClass('parent')){\r\n        menuId = jQuery(this).attr('id');\r\n        hide_submenu(function(){\r\n          menuTimeout = setTimeout(\"show_submenu(menuId);\", 600);\r\n        });\r\n      }else{\r\n        menuTimeout = setTimeout(\"hide_submenu();\", 600);\r\n      }\r\n   }, function(){});\r\n\r\n   jQuery('header').hover(function(){}, function(){\r\n      menuTimeout = setTimeout(\"hide_submenu();\", 600);\r\n   });\r\n}\r\n\r\nfunction toggleMap() {\r\n    \r\n    if (!jQuery('#map').hasClass('map-show')) {\r\n        jQuery('#map').addClass('map-show');\r\n        jQuery('#map').hide();\r\n    }\r\n    \r\n    jQuery('#map').slideToggle(\"slow\", function(){\r\n        jQuery(\"html, body\").animate({ scrollTop: jQuery(document).height() }, 1000);\r\n    });\r\n}\r\n\r\nfunction mapUp() {\r\n    jQuery('#map').slideUp(\"slow\", function(){\r\n        //jQuery(\"html, body\").animate({ scrollTop: jQuery(document).height() }, 1000);\r\n    });\r\n}\r\n\r\nfunction init_map(){\r\n  jQuery('#link-map').click(function(e){\r\n      toggleMap();\r\n      e.stopPropagation();    \r\n  });\r\n  jQuery('#map').click(function(e){\r\n      e.stopPropagation();\r\n  });\r\n  jQuery('body').click(function(){\r\n      mapUp();\r\n  });\r\n}\r\n\r\nfunction search_products(query){\r\n  jQuery('#input-search').attr('disabled', true);\r\n  jQuery('#searched-product-results').html(\"\");\r\n  React.render(\r\n    React.createElement(ProductSearch, {params: \"q=\" + query}),\r\n    document.getElementById('searched-product-results')\r\n  );\r\n}\r\n\r\nfunction search_journals(query){\r\n  jQuery('#searched-journal-results').html(\"\");\r\n  React.render(\r\n    React.createElement(PostSearch, {params: \"post_type=post&category_name=journal&q=\" + query}),\r\n    document.getElementById('searched-journal-results')\r\n  );\r\n}\r\n\r\nfunction search_projects(query){\r\n  jQuery('#searched-project-results').html(\"\");\r\n  React.render(\r\n    React.createElement(PostSearch, {params: \"post_type=project&q=\" + query}),\r\n    document.getElementById('searched-project-results')\r\n  );\r\n}\r\n\r\nfunction init_search(){\r\n  jQuery('#icon-search').on('click', function(){\r\n    jQuery('#search').height(jQuery(document).height());\r\n    jQuery('#search').fadeIn();\r\n  });\r\n\r\n  jQuery('#icon-close').on('click', function(){\r\n    jQuery('#search').fadeOut();\r\n  });\r\n\r\n  jQuery('#search form').on('submit', function(e){\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    var query = jQuery('#input-search').val();\r\n    jQuery('#search-results').show();\r\n    search_products(query);\r\n    search_journals(query);\r\n    search_projects(query);\r\n  });\r\n}\r\n\r\nfunction init_resize(){\r\n  jQuery(window).resize(function(){\r\n    init_device();\r\n  });\r\n}\r\n\r\n// init project entry point\r\njQuery(function($){\r\n  init_menu(); \r\n  init_device();\r\n  init_map();\r\n  init_resize();\r\n  init_search();\r\n});\r\n\r\n\r\n","/* search reactjs goes right under here */\nvar ProductItem = React.createClass({displayName: \"ProductItem\",\n  render: function() {\n    return (\n      React.createElement(\"div\", {className: \"product col-sm-4\"}, \n        React.createElement(\"div\", {className: \"product-image\"}, \n          React.createElement(\"a\", {href: this.props.data.image}, \n            React.createElement(\"img\", {className: \"img-responsive\", src: this.props.data.image})\n          )\n        ), \n        React.createElement(\"div\", {className: \"product-title\"}, \n          React.createElement(\"a\", {href: this.props.data.image}, \n            this.props.data.name\n          )\n        ), \n        React.createElement(\"div\", {className: \"product-price\"}, \n          this.props.data.price\n        )\n      )\n    );\n  }\n});\n\nvar ProductListMeta = React.createClass({displayName: \"ProductListMeta\",\n  render: function() {\n    var viewAllButton;\n\n    if(this.props.data.count < this.props.data.found)\n    {\n      viewAllButton = React.createElement(\"a\", {className: \"view-all\", href: \"/store/catalogsearch/result?q=\" + this.props.data.query}, \"View all\")\n    }\n    return (\n      React.createElement(\"div\", {className: \"meta\"}, \n        this.props.data.count, \" of \", this.props.data.found, \" results\", \n        viewAllButton\n      )\n    );\n  }\n});\n\nvar ProductListBox = React.createClass({displayName: \"ProductListBox\",\n  render: function() {\n    var itemNodes = _.map(this.props.data, function (item) {\n      return (\n        React.createElement(ProductItem, {data: item})\n      );\n    });\n    return (\n      React.createElement(\"div\", {className: \"product-list row\"}, \n        itemNodes\n      )\n    );\n  }\n});\n\nvar ProductSearch = React.createClass({displayName: \"ProductSearch\",\n  getInitialState: function() {\n    return {data: { items:[] }};\n  },\n  loadDataFromServer: function(){\n    if (this.props.params == null){\n      return;\n    }\n\n    jQuery.ajax({\n      url: \"/store/api-v1/product_search?\" + this.props.params,\n      dataType: 'json',\n      cache: false,\n      success: function(data) {\n        this.setState({data: data});\n        // stop product search loading\n        jQuery(React.findDOMNode(this.refs.loader)).hide();\n        jQuery('#input-search').attr('disabled', false);\n\n      }.bind(this),\n      error: function(xhr, status, err) {\n        console.error(this.props.url, status, err.toString());\n      }.bind(this)\n    });\n  },\n  componentDidMount: function() {\n    this.loadDataFromServer();\n  },\n  render: function() {\n    return (\n      React.createElement(\"div\", {className: \"results\"}, \n        React.createElement(\"div\", {className: \"loader-container\", ref: \"loader\"}, \n          React.createElement(\"div\", {className: \"loader\"})\n        ), \n        React.createElement(ProductListMeta, {data: this.state.data}), \n        React.createElement(ProductListBox, {data: this.state.data.items})\n      )\n    );\n  }\n});\n\n\n\n\n\nvar PostItem = React.createClass({displayName: \"PostItem\",\n  render: function() {\n    return (\n      React.createElement(\"div\", {className: \"post col-sm-4\"}, \n        React.createElement(\"div\", {className: \"post-image\"}, \n          React.createElement(\"a\", {href: this.props.data.image}, \n            React.createElement(\"img\", {className: \"img-responsive\", src: this.props.data.image})\n          )\n        ), \n        React.createElement(\"div\", {className: \"post-title\"}, \n          React.createElement(\"a\", {href: this.props.data.name}, \n            this.props.data.name\n          )\n        ), \n        React.createElement(\"div\", {className: \"post-date\"}, \n          this.props.data.date\n        )\n      )\n    );\n  }\n});\n\nvar PostListMeta = React.createClass({displayName: \"PostListMeta\",\n  render: function() {\n    var viewAllButton;\n\n    if(this.props.data.count < this.props.data.found)\n    {\n      viewAllButton = React.createElement(\"a\", {className: \"view-all\", href: \"/?\"+ this.props.params + \"&s=\" + this.props.data.query}, \"View all\")\n    }\n    return (\n      React.createElement(\"div\", {className: \"meta\"}, \n        this.props.data.count, \" of \", this.props.data.found, \" results\", \n        viewAllButton\n      )\n    );\n  }\n});\n\nvar PostListBox = React.createClass({displayName: \"PostListBox\",\n  render: function() {\n    var itemNodes = _.map(this.props.data, function (item) {\n      return (\n        React.createElement(PostItem, {data: item})\n      );\n    });\n    return (\n      React.createElement(\"div\", {className: \"post-list row\"}, \n        itemNodes\n      )\n    );\n  }\n});\n\nvar PostSearch = React.createClass({displayName: \"ProductSearch\",\n  getInitialState: function() {\n    return {data: { items:[] }};\n  },\n  loadDataFromServer: function(){\n    if (this.props.params == null){\n      return;\n    }\n\n    jQuery.ajax({\n      url: \"/gmg-api-v1.php?\" + this.props.params,\n      dataType: 'json',\n      cache: false,\n      success: function(data) {\n        this.setState({data: data});\n        jQuery(React.findDOMNode(this.refs.loader)).hide();\n      }.bind(this),\n      error: function(xhr, status, err) {\n        console.error(this.props.url, status, err.toString());\n      }.bind(this)\n    });\n  },\n  componentDidMount: function() {\n    this.loadDataFromServer();\n  },\n  render: function() {\n    return (\n      React.createElement(\"div\", {className: \"results\"}, \n        React.createElement(\"div\", {className: \"loader-container\", ref: \"loader\"}, \n          React.createElement(\"div\", {className: \"loader\"})\n        ), \n        React.createElement(PostListMeta, {data: this.state.data, params: this.props.params}), \n        React.createElement(PostListBox, {data: this.state.data.items})\n      )\n    );\n  }\n});"]}